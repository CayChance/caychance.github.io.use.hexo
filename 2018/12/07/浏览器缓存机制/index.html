<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><title>浏览器缓存机制 | Chance`blog</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="[object Object]"><meta name="designer" content="minfive"><meta name="keywords" content="null"><meta name="description" content="记录一些学习中遇到的问题，以及收获"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="http://yoursite.com/2018/12/07/浏览器缓存机制/index.html"><link rel="icon" type="image/png" href="https://avatars0.githubusercontent.com/u/22028125?s=460&v=4" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="Chance的个人学习笔记"><link rel="stylesheet" href="/scss/views/page/post.css"></head><body ontouchstart=""><div id="page-loading" class="page page-loading" style="background-image:url(undefined)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="Chance的个人学习笔记" alt="Chance的个人学习笔记"><img src="https://avatars0.githubusercontent.com/u/22028125?s=460&v=4" alt="Chance的个人学习笔记"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="首页" title="首页">首页</a></li><li class="nav__item"><a href="/archives" alt="归档" title="归档">归档</a></li><li class="nav__item"><a href="/about" alt="关于" title="关于">关于</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><div class="post__cover"><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fxq5re0b26j30lt09gmx6.jpg" alt="浏览器缓存机制"></div><header class="post__info"><h1 class="post__title">浏览器缓存机制</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="https://github.com/CayChance">CayChance</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2018-12-06</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/缓存/">缓存</a></li></ul></div></div></header><div class="post__content"><hr><p>（PS:这篇文章，就是纯粹的纸上谈兵哈，并没有实践过。所以一定要自己动手试试。）</p><h4 id="浏览器缓存的基本原理"><a href="#浏览器缓存的基本原理" class="headerlink" title="浏览器缓存的基本原理"></a>浏览器缓存的基本原理</h4><p>1）浏览器在加载资源时，根据请求头的<code>expires</code>和<code>cache-control</code>判断是否命中强缓存，是则直接从缓存读取资源，不会发请求到服务器。<br>2）如果没有命中强缓存，浏览器一定会发送一个请求到服务器，通过<code>last-modified</code>和<code>etag</code>验证资源是否命中协商缓存，如果命中，服务器会将这个请求返回，但是不会返回这个资源的数据，依然是从缓存中读取资源<br>3）如果前面两者都没有命中，直接从服务器加载资源</p><h4 id="浏览器缓存类型："><a href="#浏览器缓存类型：" class="headerlink" title="浏览器缓存类型："></a>浏览器缓存类型：</h4><p>浏览器的缓存分为两种：强缓存和协商缓存。</p><p>强缓存：不会向服务器发送请求，直接从缓存中读取资源。</p><p>协商缓存：向服务器发送请求，服务器会根据这个请求的request header的一些参数来判断是否命中协商缓存，如果命中，则返回304状态码并带上新的response header通知浏览器从缓存中读取资源；</p><h4 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h4><p>共同点：两者都是从客户端缓存中读取资源；区别：强缓存不会向服务器发送请求，协商缓存会向服务器发送请求。</p><h4 id="强缓存相关字段"><a href="#强缓存相关字段" class="headerlink" title="强缓存相关字段"></a>强缓存相关字段</h4><p>Expires和Cache-Control</p><p>1）Expires</p><p>Expires是http1.0提出的一个表示资源过期时间的header，它描述的是一个绝对时间，由服务器返回。<br>Expires 受限于本地时间，如果修改了本地时间，可能会造成缓存失效</p><blockquote><p>Expires: Wed, 11 May 2018 07:20:00 GMT</p></blockquote><p>2）Cache-Control</p><p>Cache-Control 出现于 HTTP / 1.1，优先级高于 Expires ,表示的是相对时间。</p><p>相对Expires而言，max-age是距离请求发起的时间的秒数。</p><blockquote><p>Cache-Control: max-age=315360000</p></blockquote><h4 id="协商缓存相关字段"><a href="#协商缓存相关字段" class="headerlink" title="协商缓存相关字段"></a>协商缓存相关字段</h4><p>协商缓存是利用的是【Last-Modified，If-Modified-Since】和【ETag、If-None-Match】这两对Header来管理的。</p><p>1）Last-Modified，If-Modified-Since</p><p><code>Last-Modified</code> 表示本地文件最后修改日期，浏览器会在request header加上<code>If-Modified-Since</code>（上次返回的<code>Last-Modified</code>的值），询问服务器在该日期后资源是否有更新，有更新的话就会将新的资源发送回来</p><p>但是如果在本地打开缓存文件，就会造成 Last-Modified 被修改，所以在 HTTP / 1.1 出现了 ETag</p><p>2）ETag、If-None-Match</p><p><code>Etag</code>就像一个指纹，资源变化都会导致<code>ETag</code>变化，跟最后修改时间没有关系，<code>ETag</code>可以保证每一个资源是唯一的</p><p><code>If-None-Match</code>的header会将上次返回的<code>Etag</code>发送给服务器，询问该资源的<code>Etag</code>是否有更新，有变动就会发送新的资源回来</p><p>3）ETag的优先级比Last-Modified更高</p><p>具体为什么要用<code>ETag</code>，主要出于下面几种情况考虑：</p><ul><li>一些文件也许会周期性的更改，但是他的内容并不改变(仅仅改变的修改时间)，这个时候我们并不希望客户端认为这个文件被修改了，而重新GET；</li><li>某些文件修改非常频繁，比如在秒以下的时间内进行修改，(比方说1s内修改了N次)，If-Modified-Since能检查到的粒度是s级的，这种修改无法判断(或者说UNIX记录MTIME只能精确到秒)；</li><li>某些服务器不能精确的得到文件的最后修改时间。</li></ul><p><a href="https://github.com/amandakelake/blog/issues/41" target="_blank" rel="noopener">参考链接</a><br><a href="https://mp.weixin.qq.com/s?__biz=MjM5MTA1MjAxMQ==&amp;mid=2651226262&amp;idx=1&amp;sn=2128db200b88479face67ed8e095757c&amp;chksm=bd4959128a3ed0041b43a5683c75c4b88c7d35fac909a59c14b4e9fc11e8d408680b171d2706&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">参考链接</a></p><div class="post-announce">感谢您的阅读，本文由 <a href="http://yoursite.com">Chance的个人学习笔记</a> 版权所有。如若转载，请注明出处：Chance的个人学习笔记（<a href="http://yoursite.com/2018/12/07/浏览器缓存机制/">http://yoursite.com/2018/12/07/浏览器缓存机制/</a>）</div><div class="post__prevs"><div class="post__prev"><a href="/2018/12/06/js-event-loop/" title="js event loop"><i class="iconfont icon-prev"></i>js event loop</a></div><div class="post__prev post__prev--right"><a href="/2018/12/14/js继承方法总结/" title="js继承方法总结">js继承方法总结<i class="iconfont icon-next"></i></a></div></div></div></article></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">简介</h3><p class="block__text">记录一些学习中遇到的问题，以及收获</p></div><div class="sidebar__block"><h3 class="block__title">文章分类</h3><ul class="block-list"><li class="block-list-item"><a class="block-list-link" href="/categories/跨域/">跨域</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/工具/">工具</a><span class="block-list-count">5</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/js/">js</a><span class="block-list-count">5</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/html/">html</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/css/">css</a><span class="block-list-count">1</span></li><li class="block-list-item"><a class="block-list-link" href="/categories/bug排查/">bug排查</a><span class="block-list-count">1</span></li></ul></div><div class="sidebar__block"><h3 class="block__title">最新文章</h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/2019/02/01/MongoDB基础入门/" title="MongoDB基础入门"><div class="item__cover"><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fzsi9f7widj30aa06d0ub.jpg" alt="MongoDB基础入门"></div><div class="item__info"><h3 class="item__title">MongoDB基础入门</h3><span class="item__text">2019-02-01</span></div></a></li><li class="latest-post-item"><a href="/2019/01/26/Vue项目的整体认识/" title="Vue项目的整体认识"><div class="item__cover"><img src="https://ws3.sinaimg.cn/large/006tNc79ly1fzfmmigsmxj309e0453ya.jpg" alt="Vue项目的整体认识"></div><div class="item__info"><h3 class="item__title">Vue项目的整体认识</h3><span class="item__text">2019-01-25</span></div></a></li><li class="latest-post-item"><a href="/2019/01/23/Vuex存储的时候遇到的问题及解决方案/" title="Vuex存储的时候遇到的问题及解决方案"><div class="item__cover"><img src="https://ws3.sinaimg.cn/large/006tNc79ly1fzfmmigsmxj309e0453ya.jpg" alt="Vuex存储的时候遇到的问题及解决方案"></div><div class="item__info"><h3 class="item__title">Vuex存储的时候遇到的问题及解决方案</h3><span class="item__text">2019-01-22</span></div></a></li><li class="latest-post-item"><a href="/2019/01/19/find-记一次生产的bug排查/" title="find-记一次生产的bug排查"><div class="item__cover"><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fxq5re0b26j30lt09gmx6.jpg" alt="find-记一次生产的bug排查"></div><div class="item__info"><h3 class="item__title">find-记一次生产的bug排查</h3><span class="item__text">2019-01-18</span></div></a></li></ul></div><div class="sidebar__block"><h3 class="block__title">文章标签</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/MongoDB/">MongoDB</a></li><li class="tag-item"><a class="tag-link" href="/tags/Vue/">Vue</a></li><li class="tag-item"><a class="tag-link" href="/tags/Vuex/">Vuex</a></li><li class="tag-item"><a class="tag-link" href="/tags/css/">css</a></li><li class="tag-item"><a class="tag-link" href="/tags/event-loop/">event loop</a></li><li class="tag-item"><a class="tag-link" href="/tags/find-bug/">find bug</a></li><li class="tag-item"><a class="tag-link" href="/tags/flex/">flex</a></li><li class="tag-item"><a class="tag-link" href="/tags/git/">git</a></li><li class="tag-item"><a class="tag-link" href="/tags/github/">github</a></li><li class="tag-item"><a class="tag-link" href="/tags/label/">label</a></li><li class="tag-item"><a class="tag-link" href="/tags/markdown/">markdown</a></li><li class="tag-item"><a class="tag-link" href="/tags/七牛云/">七牛云</a></li><li class="tag-item"><a class="tag-link" href="/tags/异步-Promise-Generator-async/">异步 Promise Generator async</a></li><li class="tag-item"><a class="tag-link" href="/tags/继承/">继承</a></li><li class="tag-item"><a class="tag-link" href="/tags/缓存/">缓存</a></li><li class="tag-item"><a class="tag-link" href="/tags/解构-函数参数默认值/">解构 函数参数默认值</a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">关于</h3><div class="item__content"><p class="item__text">本站是基于 Hexo 搭建的静态资源博客，主要用于分享日常学习、生活及工作的一些心得总结，欢迎点击右下角订阅 rss。</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Beijing, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>824997834@qq.com</span></li></ul></div></div><div class="footer-top__item footer__image"><img src="https://avatars0.githubusercontent.com/u/22028125?s=460&v=4" alt="logo" title="Chance的个人学习笔记"></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">© <a href="https://github.com/Mrminfive/hexo-theme-skapp" target="_blank">Skapp</a> 2017 powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, made by <a href="https://github.com/Mrminfive" target="_blank">minfive</a>.</p><ul class="footer__social-network clearfix"><li class="social-network__item"><a href="https://github.com/CayChance" target="_blank" title="github"><i class="iconfont icon-github"></i></a></li><li class="social-network__item"><a href="mailto:824997834@qq.com" target="_blank" title="email"><i class="iconfont icon-email"></i></a></li><li class="social-network__item"><a href="/atom.xml" target="_blank" title="rss"><i class="iconfont icon-rss"></i></a></li></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>